<<<BEGIN>>>
# 01_topic-template_修正版.md（技術深掘りユニット雛形：基準ファイル粒度対応版）

> 用途：`01_topics/` 配下の各ファイル（1ファイル=1スキルユニット）を、この雛形で作成・修正する。  
> 方針：ツール/コマンドの紹介で終わらせず「意味→判断→次の一手」まで必ず落とし込む。  
> 注意：本文内でコードやコマンド例を書く場合は `~~~~` 〜 `~~~~` を使用する（``` は使わない）。  
> 禁止：章として「よくある落とし穴」を作らない。  
> 基準ファイル：`01_topics/03_network/28_exfiltration_持ち出し経路（DNS_HTTP_SMB）.md`、`01_topics/02_web/15_payment_重要操作境界（3DS_返金）.md` の粒度に合わせる。

---

## 修正ポイント（01_dns_委譲・境界・解釈.mdで確立した形式）

### 1. タイトル形式
- 「## タイトル」ではなく「# ファイル名（拡張子除く）」形式
- 例：`01_dns_委譲・境界・解釈.md` → `# 01_dns_委譲・境界・解釈`
- その下にタイトル説明文を記載

### 2. セクション順番（テンプレート順に従う）
1. # ファイル名（タイトル）
2. 目的（この技術で到達する状態）
3. 前提（対象・範囲・想定）
   - 「扱う範囲」はここに統合
4. 観測ポイント（何を見ているか：プロトコル/データ/境界）
5. 結果の意味（その出力が示す状態：何が言える/言えない）
6. 攻撃者視点での利用（意思決定：優先度・攻め筋・次の仮説）
7. 次に試すこと（仮説A/Bの分岐と検証）
8. 手を動かす検証（Labs連動：観測点を明確に）
   - 「実施方法」はここに統合（証跡ディレクトリ、相関キー、観測の取り方）
9. コマンド/リクエスト例（例示は最小限・意味の説明が主）
10. ガイドライン対応（ASVS / WSTG / PTES / MITRE ATT&CK：毎回記載）
11. 参考（必要最小限）
12. リポジトリ内リンク（最大3つまで）
13. 深掘りリンク（最大8件）※基準ファイルの粒度に合わせて追加

### 3. 基準ファイルの粒度に合わせる要素
- 実施方法の具体化（証跡ディレクトリ、相関キー、観測の取り方）
- 診断観点（観測→判断→次の一手）※「次に試すこと」や「攻撃者視点」に統合可能
- よくある失敗パターン（実務で刺さる）※必要に応じて「参考」や「結果の意味」に統合可能
- 深掘りリンク（最大8件）を最後に追加

### 4. ガイドライン対応の形式
- 冒頭ではなく、テンプレート順番通り「コマンド例」の後に配置
- URLを含む詳細版（基準ファイルの粒度に合わせる）

---

## テンプレート本体

# ファイル名（拡張子除く）
（例：01_dns_委譲・境界・解釈 / 02_tls_証明書・CT・外部依存推定 など）
（タイトル説明文：この技術で何を観測・解釈するか）

## 目的（この技術で到達する状態）
- （例）観測結果から「境界（資産/信頼/権限）」を推定し、攻め筋の優先度と次の検証を自走で決められる
- （例）同じ現象でも条件差（環境/設定/設計）で解釈が変わることを切り分けられる

## 前提（対象・範囲・想定）
- 対象：
- 想定する環境（例：クラウド/オンプレ、CDN/WAF有無、SSO/MFA有無）：
- できること/やらないこと（安全に検証する範囲）：
- 依存する前提知識（必要最小限）：
- 扱う範囲（本ファイルの守備範囲）
  - 扱う：
  - 扱わない（別ユニットへ接続）：
    - （例）関連する別トピック → `関連ファイル名.md`

## 観測ポイント（何を見ているか：プロトコル/データ/境界）
- 観測対象（プロトコル/データ構造/やり取りの単位）：
- 境界の観点：
  - 資産境界（管理主体・委託先・対象範囲の線引き）：
  - 信頼境界（外部連携・第三者・越境ポイント）：
  - 権限境界（権限の切替/伝播/委任）：
- 重要なフィールド/差分/状態（「ここが変わると意味が変わる」点）：

## 結果の意味（その出力が示す状態：何が言える/言えない）
- 何が“確定”できるか：
- 何が“推定”できるか（推定の根拠/前提）：
- 何は“言えない”か（不足情報・観測限界）：
- よくある状態パターン（正常/異常/境界がズレている等）：
  - パターンA：
  - パターンB：
  - パターンC：

## 攻撃者視点での利用（意思決定：優先度・攻め筋・次の仮説）
- この状態が示す“狙い目”：
- 優先度の付け方（時間制約がある場合の順序）：
- 代表的な攻め筋（この観測から自然に繋がるもの）：
  - 攻め筋1：
  - 攻め筋2：
- 「見える/見えない」による戦略変更（例：CDN配下、SSO前提、外部委託先など）：

## 次に試すこと（仮説A/Bの分岐と検証）
> ここが最重要。条件が違うと次の手が変わる形で書く。

- 仮説A：（成立条件）
  - 次の検証：
  - 期待する観測（成功/失敗時に何が見えるか）：
- 仮説B：（成立条件）
  - 次の検証：
  - 期待する観測：
- 仮説C：（必要なら）

## 手を動かす検証（Labs連動：観測点を明確に）
- 検証環境（関連する `04_labs/`）
  - 参照ファイル：
- 取得する証跡（目的ベースで最小限）：
  - （例）HTTPログ/har、pcap、サーバログ、クラウド監査ログ 等
- 観測の取り方（どの視点で差分を見るか）：
- 実施方法（最高に具体的）：観測の準備と相関キー
  - 証跡ディレクトリ（必須）
    ~~~~
    mkdir -p ~/keda_evidence/トピック名 2>/dev/null
    cd ~/keda_evidence/トピック名
    ~~~~
  - 検証の前提を固定（スコープ事故を防ぐ）
    - 必須で決める（レポート先頭に書く）
      - 対象は **許可されたスコープ** のみ
      - 観測は **代表点の抽出** のみ
      - （その他の前提）
  - 相関キー（最低限）を作る（後で必ず効く）
    - （例）Host、User、Time、Destination、Volume、Identifier 等

## コマンド/リクエスト例（例示は最小限・意味の説明が主）
> 例示は“手段”であり“結論”ではない。必ず「何を観測している例か」を添える。

~~~~
（ここに最小限の例：コマンド/リクエスト/設定例）
~~~~

- この例で観測していること：
- 出力のどこを見るか（注目点）：
- この例が使えないケース（前提が崩れるケース）：

## ガイドライン対応（ASVS / WSTG / PTES / MITRE ATT&CK：毎回記載）
- ASVS：
  - 該当領域/章：
  - 該当要件（可能ならID）：
  - このファイルの内容が「満たす/破れる」ポイント：
    - 破れる：
    - 満たす：
  - 参照：https://github.com/OWASP/ASVS
- WSTG：
  - 該当カテゴリ/テスト観点：
  - 該当が薄い場合：この技術が支える前提（情報収集/境界特定/到達性推定 等）：
  - 参照：https://owasp.org/www-project-web-security-testing-guide/
- PTES：
  - 該当フェーズ：
  - 前後フェーズとの繋がり（1行）：
  - 参照：https://pentest-standard.readthedocs.io/
- MITRE ATT&CK：
  - 該当戦術（必要なら技術）：
  - 攻撃者の目的（この技術が支える意図）：
  - 参照：https://attack.mitre.org/tactics/（該当する戦術のURL）

## 参考（必要最小限）
- （一次情報・公式ドキュメント・仕様・ガイドラインURL等を必要分だけ）
- （事例や検証メモは `03_cases/` や `04_labs/` に寄せ、ここは肥大化させない）

## リポジトリ内リンク（最大3つまで）
- 関連 topics：
- 関連 playbooks：
- 関連 labs / cases：

---

## 深掘りリンク（最大8）
- `関連ファイル1.md`
- `関連ファイル2.md`
- （最大8件まで）

---

<<<END>>>

